\documentclass[12pt,a4paper]{article}
\usepackage{fullpage}
\usepackage[top=2cm, bottom=4.5cm, left=2.5cm, right=2.5cm]{geometry}
\usepackage{amsmath,amsthm,amsfonts,amssymb,amscd}
\usepackage{enumerate}
\usepackage{fancyhdr}
\usepackage{xcolor}
\usepackage{mathpartir}
\usepackage{listings}
\usepackage{hyperref}
\usepackage{mathabx}
\usepackage{tabularx}
\usepackage{graphicx}
\usepackage{caption}
\usepackage{subcaption}
\hypersetup{%
	colorlinks=false,
	linkbordercolor=white
}

\setlength{\parindent}{0.0in}
\setlength{\parskip}{0.05in}

\newcommand\course{Program Analysis and Verification}
\newcommand\namea{Ilya Shervin 308640218}
\newcommand\nameb{Dmitry Kuznetsov 322081183}

\newcommand{\trans}[1]{[\![\texttt{#1}]\!]}
\newcommand{\atrans}[1]{\trans{#1}^\sharp}
\lstset{basicstyle=\small}
\newcommand{\example}[2]{
\input{#1/examples/example#2.tex}
\begin{figure}[h!]
\centering
\begin{subfigure}{.5\textwidth}
  \centering
  \includegraphics[scale=0.3]{#1/examples/example#2-cfg}
  \caption{Control flow graph}
\end{subfigure}%
\begin{subfigure}{.5\textwidth}
  \centering
  \lstset{basicstyle=\small}
  \lstinputlisting{#1/examples/example#2.code}
  \caption{Code}
\end{subfigure}
\caption*{Example #2}
\end{figure}
}

\lstset{
frame = single, 
breaklines=true,
framexleftmargin=1pt}


\pagestyle{fancyplain}
\headheight 35pt  
\lhead{\namea\\\nameb}
\chead{\textbf{\Large Final Project}}
\rhead{\course \\ \today}
\lfoot{}
\cfoot{}
\rfoot{\small\thepage}
\headsep 1.5em

\begin{document}
	\section*{Intro}
	This document accompanies the code of the final project in Program Analysis and Verification class. Following is a brief rundown of code structure and components.
	
	All of the analysis tasks are implemented with Python 3 (3.7+) with the environment and dependencies managed by Pipenv\footnote{https://docs.pipenv.org} (see docs for elaborate usage examples).
	
	Our code relies on the following external software packages:
	\begin{itemize}
		\item SLY\footnote{https://github.com/dabeaz/sly} - a Python implementation of lex/yacc analogues lexers and parsers.
		\item pySMT\footnote{https://github.com/pysmt/pysmt} - a front-end for solving formulas
%		\item z3-solver\footnote{http://z3prover.github.io} - a backend for PySMT based on Z3
		\item graphviz\footnote{https://github.com/xflr6/graphviz} - a library for visualization of control flow graphs
		\item pytest\footnote{https://docs.pytest.org} - as a test harness
	\end{itemize}
The general method of operation for all of the analysis implementations is as following:
\begin{itemize}
	\item Parse the input file according to the language definition of the program (parity/sum/shape).
	\item Construct the control flow graph of the program.
	\item Initialize all the nodes in control flow graph to the initial abstract state (depending on the abstract domain of specific analysis).
	\item Perform chaotic iteration until no more updates happen.
	\item Iterate over assert statements and verify their validity against the abstract state of the graph node.
\end{itemize}
Finally, the results are displayed on the console as a DOT graph with a link for easy visualization.

\section*{Installing and Running}
Development of the analysis was done on Linux (Fedora/Ubuntu). To set up a Python environment, run \texttt{pipenv install} in the root directory of the project. This will initialize a new virtual environment and pull required packages. Additionally several system packages will be required, namely:
\begin{itemize}
	\item \texttt{graphviz}
	\item \texttt{z3solver}
\end{itemize}

Invocation of analysis is done through \texttt{pipenv run analyze}:
\lstinputlisting{analyze.usage}

\input{parity}
\input{sum}
\end{document}
